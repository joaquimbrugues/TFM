\section{Pseudogradients and the Smale condition} \label{section:pseudogradients}

\subsection{Pseudogradients}

In this section we will focus on how we can connect the points of $\crit(f)$ (for a Morse function) between them. The way to do this, in $\R^n$, would be the gradient of the function, this means,

$$\grad f = \left( \der{f}{x_1},...,\der{f}{x_n} \right) .$$

This vector field can be intrinsecally defined on a manifold $M$ using a metric $\langle \cdot , \cdot \rangle$ as the only vector field that satisfies that, for any vector field $Y \in \mathfrak{X}(M)$,

$$\langle \grad f, Y \rangle = \dd f \cdot Y .$$

For our purposes, we do not need to use precisely the gradient of a function, and sometimes it might not satisfy the properties that we need for the flow, so we introduce the more general concept of {\bf pseudogradient}.

\begin{deff}
Let $f$ be a Morse function defined on $M$. Then, a vector field $X \in \mathfrak{X}(M)$ is a {\bf pseudogradient} adapted to $f$ if it satisfies the two conditions

\begin{enumerate}
\item For every $x \in M$ we have $(\dd f)_x \cdot X_x \leq 0$, and the equality holds if and only if $x$ is a critical point for $f$.
\item For each critical point of $f$, $X$ coincides with the negative gradient defined with the canonical metric defined in $\R^n$ on the domain of the Morse chart.
\end{enumerate}
\end{deff}

\begin{rmrk}
If $(M,g)$ is a manifold with a Riemannian metric, then the vector field $- \grad f$ defined using $g$ is a pseudogradient.
\end{rmrk}

As with Morse functions, one might ask if pseudogradients do exist. As before, the answer is affirmative:

\begin{prop}
Let $M$ be a compact and smooth manifold, and $f$ a Morse function on $M$. Then, there exists a pseudogradient field $X$ adapted to $f$.
\end{prop}

\begin{proof}
Let $c_1,...,c_r$ be the critical points of $f$ (there are finitely many because the non-degenerate critical points are isolated and $M$ is compact), and let $(U_1,h_1),...,(U_r,h_r)$ be Morse charts in the neighbourhoods of these points. We assume that the images of these charts, which we will denote $\Omega_1,...,\Omega_r$, are disjoint. We can add more charts to get a finite open cover of $M$, $\{\Omega_j\}_{1 \leq j \leq m}$. Also, refine the open cover so that each critical point $c_i$ is contained only on its associated open set $\Omega_i$.

For each $\Omega_i$, let $X_i$ be the push-forward of the negative gradient of $\tilde{f}$ in $U_i$ by $h_i$. Also, take a partition of unity associated to $\{\Omega_j\}_{1 \leq j \leq m}$, $\{\varphi_j\}_{1 \leq j \leq m}$. Then, we can define the vector fields

$$\widetilde{X}_j(x) = \left\{ \begin{array}{ll} \varphi_j(x) X_j & \text{if } x \in \Omega_j \\ 0 & \text{otherwise} \end{array} \right. ,$$

and

$$X = \sum_{j=1}^m \widetilde{X}_j .$$

Then, the two conditions to be a pseudogradient adapted to $f$ are satisfied:

\begin{enumerate}
\item If we compute

$$\\d f_x \cdot X_x = \sum_{j=1}^m \\d f_x \cdot \widetilde{X}_{j,x} \leq 0 ,$$

and the inequality is an equality iff $\varphi_j(x) X_j(x) = 0$ for every $j$, so that either $x$ is a critical point, or $\varphi_j(x)=0$ for all $j$, which is impossible since $\{\varphi_j\}_{1\leq j \leq m}$ form a partition of unity.
\item Let $c_i$ be a critical point. By construction, $X$ coincides with the image of the negative gradient with the canonical metric over $U_i \bigcap \left( \bigcup_{i \neq j} U_j\right)$, which, also by construction, contains a neighbourhood of $c_i$.
\end{enumerate}
\end{proof}

Going back to the question of how to connect two critical points, let us define the stable and unstable manifolds:

\begin{deff}
Let $a$ be a critical point of $f$, and $X$ a pseudogradient adapted to $f$. We denote by $\varphi^s$ the flow of $X$. We define the {\bf stable manifold} of $a$ as

$$W^s(a) = \left\{ x \in M \ | \ \lim_{s \rightarrow + \infty} \varphi^s(x) = a \right\}, $$

and its {\bf unstable manifold} as

$$W^u(a) = \left\{ x \in M \ | \ \lim_{s \rightarrow - \infty} \varphi^s(x) = a \right\} .$$
\end{deff}

These are, actually, smooth manifolds, and it can be shown that they are diffeomorphic to open disks. Moreover, we have that

$$\text{dim} W^u(a) = \text{codim} W^s(a) = \text{Ind}(a) .$$

Finally, we want to see that the flow of a pseudogradient does actually connect critical points. To this end, we have the following result:

\begin{prop} \label{prop:connect_critical_points}
Let $M$ a compact manifold, $f$ a Morse function and $\gamma : \R \rightarrow M$ a trajectory of a pseudogradient field $X$. Then, there are critical points $a$ and $b$ such that

\begin{displaymath}
\lim_{s \rightarrow - \infty} \gamma(s) = a \ , \text{ and } \lim_{s \rightarrow + \infty} \gamma(s) = b .
\end{displaymath}
\end{prop}

\begin{proof}
Let us prove this result in the case that $s \rightarrow + \infty$, as the case for $- \infty$ is proved the same way. Suppose that the result is false, so there is a trajectory $\gamma$ such that it has no limit to $+ \infty$. Then, each time that $\gamma$ enters a Morse neighbourhood for any critical point $c_i$, $\Omega_i$, it must leave sometime later, because $f$ is strictly decreasing along the trajectories of a pseudogradient. Thus, there is a time $s_0 > 0$ such that $\forall s > s_0$,

$$\gamma(s) \in M \backslash \bigcup_i \Omega_i ,$$

so $\dd f(\gamma(s)) \cdot X(s) \leq - \e_0$ for some $\e_0 > 0$ and for any $s > s_0$.

Therefore, for any $s > s_0$,

\begin{displaymath}
f(\gamma(s))-f(\gamma(s_0)) = \int_{s_0}^s \frac{\dd (f \circ \gamma)}{\dd t} \dd t = \int_{s_0}^s \dd f(\gamma(t)) \cdot X(\gamma(t)) \dd t \leq - \e_0 (s-s_0) .
\end{displaymath}

This leads to the conclusion that $\displaystyle\lim_{s \rightarrow +\infty} f(\gamma(s)) = - \infty$, which is impossible.
\end{proof}

\subsection{The Smale condition}

The notion of connecting critical points between them needs to be complemented by the fact that the intersection of the unstable and stable manifolds is good enough, in the sense that it is regular. In particular, the notion that we need is the following.

\begin{deff}
Let $M$ a smooth manifold, and $S, T \subset M$ smooth submanifolds. We say that $S$ and $T$ {\bf intersect transversally} if, $\forall p \in L \bigcap T$,

$$\straightT_pM = \straightT_pS + \straightT_pT .$$

Notice that the sum in the definition does not need to be direct, so it is possible that $\text{dim}(S)+\text{dim}(T) \geq \text{dim}(M)$.

If $S$ and $T$ intersect transversally, we denote it as $S \pitchfork T$.
\end{deff}

It can be proved that, if $S$ and $T$ intersect transversally, then:

\begin{enumerate}
	\item $S \cap T$ is a submanifold of $M$.
	\item $\text{dim}(M) = \text{dim}(S) + \text{dim}(T) - \text{dim}(S \cap T)$.
\end{enumerate}

\begin{deff}
We say that a pseudogradient $X$ adapted to $f$ satisfies the {\bf Palais-Smale condition} if, for any $a,b \in \crit(f)$,

$$W^u(a) \pitchfork W^s(b) .$$
\end{deff}

\begin{rmrk}
If $X$ satisfies the Palais-Smale condition, then for any pair of critical points $a$ and $b$, we have that

\begin{equation} \label{eq:dimIntersect}
\text{dim}(W^u(a) \cap W^s(b)) = \text{Ind}(a) - \text{Ind}(b) .
\end{equation}
\end{rmrk}

%TODO: Prove existence and genericness of such pseudogradients.
%TODO: Provide the lemma that says that for each pseudogradient there is another one satisfying P-S.

Let $\mathcal{M}(a,b) := W^u(a) \cap W^s(b)$. It is the space of the trajectories going from $a$ to $b$. The group $\R$ acts freely and transitivelly on $\mathcal{M}(a,b)$ by

\begin{displaymath}
t \cdot p = \varphi_X^t(p) .
\end{displaymath}

\begin{deff}
Let $\mathcal{L}(a,b)$ denote the {\bf space of trajectories} between $a$ and $b$, that we define as

\begin{displaymath}
\mathcal{L}(a,b) := \quocient{\mathcal{M}(a,b)}{\R} .
\end{displaymath}
\end{deff}

%TODO: reference this correctly
\begin{rmrk}
As a consequence of formula \ref{eq:dimIntersect}, the dimension of the space of trajectories is

\begin{displaymath}
\text{dim}(\mathcal{L}(a,b)) = \text{Ind}(a) - \text{Ind}(b) - 1 .
\end{displaymath}
\end{rmrk}

\begin{coro}
If $\text{Ind}(a)-\text{Ind}(b) = 1$, then the set $\mathcal{L}(a,b)$ is discrete.
\end{coro}

\subsection{Critical points of compact 1-dimensional manifolds}

Here, we are going to use what we learned about Morse functions and pseudogradients to prove a classification theorem for compact 1-dimensional manifolds that will be important in the following section.

First of all, we need to define the notion of incoming vector field of a manifold with boundary.

\begin{deff}
Consider $M$ a manifold with boundary, and let $X$ be a vector field defined on $M$. We say that $X$ is {\bf incoming} on the boundary of $M$ if, for any chart covering a part of $\partial M$, the local representation of $X$ is

$$\tilde{X} = \sum_{i=1}^n a_i \frac{\partial}{\partial x_i} ,$$

with $a_i$ functions such that $a_i(\varphi^{-1}(q)) < 0 \ \forall q \in \partial M$.
\end{deff}

\begin{lema} \label{incomingadapted}
For any manifold with boundary $M$, we can construct a pair $(f,X)$ of Morse function and pseudogradient adapted to it such that $X$ is incoming.
\end{lema}

\begin{theo} \label{1dimensional}
Let $M$ be a compact and connected manifold of dimension 1. Then, $M$ is diffeomorphic to $\con{S}^1$ if it has no boundary, and to $[0,1]$ otherwise.
\end{theo}

\begin{proof}
First of all, construct a pair $(f,X)$ of Morse function and incoming pseudogradient adapted to $f$ as indicated in lemma \ref{incomingadapted}. As $M$ is 1-dimensional, the critical points of $f$ can only be local minima and maxima. Let $c_1,...,c_k$ be the minima of $f$. Notice that there has to be a finite number of critical points of $f$ in $M$, because critical points of a Morse function must be isolated and $M$ is compact.

By definition, the stable manifold of $c_i$, $W^s(c_i)$, is an open interval embedded in $M$. Let $A_i$ be the closure of this stable manifold. Then, we are adding the starting points of the trajectories of $W^s(c_i)$. There are two options:

\begin{itemize}
	\item They are both local maxima (they may or may not coincide).
	\item At least one of them is a boundary point of $M$, so the points must be distinct.
\end{itemize}

Also, note that $M = \bigcup_i A_i$. Therefore, if $x \in M$ there are two options: either $x \in W^s(c_i)$ for some minimum $c_i$, or $x$ is a local maximum, but then it belongs to the closure of a stable manifold.

If $k=1$, the theorem is already proved, so consider $k \geq 2$. As $M$ is connected, there is some $i \geq 2$ such that $A_1 \cap A_i \neq \emptyset$. The intesection may only contain local maxima that are not boundary points, because they are points from which the trajectories reach different minimum points. Thus, $\partial M \cap (A_1 \cap A_i) = \emptyset$. There are two options:

\begin{itemize}
	\item The intesection contains two points. Then, they are both local maxima, $A_1 \cup A_i \cong \con{S}^1$ and we are done.
	\item The intersection contains a single point. Then, $A_1 \cup A_i \cong [0,1]$. If $A_1 \cup A_i = M$, we are done.
\end{itemize}

Otherwise, we can replace $A_1$ by $A_1 \cup A_i$ in the collection of closed sets $\{A_i\}_i$, and remove $A_i$ from this list. Then, we can repeat the same argument with the collection $\{A_1,...,A_{i-1},A_{i+1},...,A_k\}$, which contains $k-1$ sets. Therefore, we may apply the process a finite number of times, and end up with one of the cases above.
\end{proof}
