\section{The rotation map}

The index that we define in this chapter has an intuitive interpretation in terms of the topology of $Sp(\R^{2n},\Omega_0)$. In particular, it relies in the fact (that we will prove) that $\pi_1(Sp(\R^{2n},\Omega_0)) \cong \con{Z}$. In particular, we will see that $Sp(\R^{2n},\Omega_0)$ can always be regarded as the topological product of $\con{S}^1$ with a simply connected space. From this we will produce a map $\rho : Sp(\R^{2n},\Omega_0) \rightarrow \con{S}^1$, the rotation map, that will allow us to define the Conley-Zehnder index in terms of the degree of a map from $\con{S}^1$ to itself.

\subsection{The topology of $Sp(\R^{2n},\Omega_0)$}

Recall that the symplectic group of dimension $2n$ is the subgroup of $GL(\R^{2n})$ defined by
\[Sp(\R^{2n}, \Omega_0) = \{A \in GL(\R^{2n} \ | \ A^T \Omega_0 A = \Omega_0\} ,\]
where
\[\Omega_0 = \begin{pmatrix} 0 & \Id \\ - \Id & 0 \end{pmatrix} .\]
We have the following result about the structure of this group:

\begin{theo} Let $A \in GL(\R^{2n})$ be an invertible matrix. Then, there exists a unique decomposition $A = OP$ such that $O$ is orthogonal and $P$ is symmetric and positive definite. Moreover, if $A$ is symplectic, then both $O$ and $P$ are symplectic, so $O \in U(n)$ (the complex unitary matrix group of dimension $n$), and $P = \text{exp}(S)$ for some symmetric matrix in the Lie algebra of $Sp(\R^{2n},\Omega_0)$.

If we denote $V = \mathfrak{sp}(\R^{2n},\Omega_0) \bigcap \text{Sym}(\R^{2n})$, then we deduce that this decomposition induces a topological factorization

\[Sp(\R^{2n}, \Omega_0) \cong U(n) \times V ,\]
where $V$ is a vector space, so $Sp(\R^{2n},\Omega_0) \simeq U(n)$.
\end{theo}

\begin{proof}
The matrix $A^TA$ is symmetric and positive definite, so there is an orthogonal matrix $Q$ such that $QA^TAQ^T = \text{diag}(a_1,...,a_{2n})$ with all the $a_i$ real and strictly positive. Let us define the matrices

\[P = Q^T\text{diag}(\sqrt{a_1},...,\sqrt{a_{2n}}) Q, \]
\[S = Q^T\text{diag}(\ln(a_1),...,\ln(a_{2n})) Q ,\]
so they are the unique matrices such that $P^2 = A^TA$ and $\text{exp}(S) = A^TA$. Then, we define $O = AP^{-1}$. It is an orthogonal matrix, because

\[O^TO = P^{-1}A^TAP^{-1} = P^{-1} P^2 P^{-1} = \text{Id} .\]
Moreover, it is a symplectic matrix, because, as $A$ is symplectic,
\[A = \Omega_0^{-1} (A^T)^{-1} \Omega_0,\]
so\footnote{Here we use several times the fact that $\Omega_0^{-1} = -\Omega_0$.}
\[OP = \Omega_0^{-1}((OP)^T)^{-1} \Omega_0 = \Omega_0^{-1} (O^T)^{-1} (P^T)^{-1} \Omega_0 = \Omega_0^{-1} (O^T)^{-1} \Omega_0 \Omega_0^{-1} (P^T)^{-1} \Omega_0\]
and, by the uniqueness of the decomposition, $O = \Omega_0^{-1} O \Omega_0$ and $P = \Omega_0^{-1} P \Omega_0$.

On the other hand, we have that $P = \text{exp}(\frac12 S)$ and, as $P$ is symplectic, we know that $S \in \mathfrak{sp}(\R^{2n},\Omega_0)$.

Therefore, we have shown that $Sp(\R^{2n}, \Omega_0) \cong U(n) \times V$.
\end{proof}

\begin{prop}
The complex unitary group is homeomorphic to the product $\con{S}^1 \times SU(n)$ (the special unitary group). Moreover, $SU(n)$ is simply connected. Therefore, $\pi_1(U(n)) = \con{Z}$, so $\pi_1(Sp(\R^{2n},\Omega_0)) = \con{Z}$.
\end{prop}

\begin{proof}
The bijection between $U(n)$ and $\con{S}^1 \times SU(n)$ is easily stablished by the map
\[\begin{array}{ccc} \con{S}^1 \times SU(n) & \longrightarrow & U(n) \\ (e^{\varphi i}, O) & \longmapsto & \text{diag}(e^{\varphi i},1,...,1) O \end{array}\]
whose inverse associates to a unitary matrix $O$ its determinant $\text{det}(O) = e^{\varphi i}$ and the special unitary matrix $\text{diag}(e^{-\varphi i},1,...,1) O$.

To prove that $SU(n)$ is simply connected we can use its action on the sphere $\con{S}^{2n-1} = \{z \in \con{C} \ | \ |z|^2 = 1\}$. This action is transitive, and the isotropy group at $(1,0,...,0)$ is $SU(n-1)$. Therefore, we get that
\[\quocient{SU(n)}{SU(n-1)} \cong \con{S}^{2n-1} .\]
The long exact sequence of this quotient gives that
\[\cdots \rightarrow \pi_2(\con{S}^{2n-1}) \rightarrow \pi_1(SU(n-1)) \rightarrow \pi_1(SU(n)) \rightarrow \pi_1(\con{S}^{2n-1}) .\]
If $n > 1$ then $\pi_2(\con{S}^{2n-1}) = 0$ and $\pi_1(\con{S}^{2n-1})=0$. Moreover, $SU(1)=\{1\}$. Therefore,
\[\pi_1(SU(n)) \cong \pi_1(SU(n-1)) \cong \cdots \cong \pi_1(SU(1)) = \pi_1(\{1\}) = 0,\]
and therefore $SU(n)$ is simply connected $\forall n \geq 1$.
\end{proof}

This fact provides an idea of how to proceed: we can define a map $f : Sp(\R^{2n},\Omega_0) \rightarrow \con{S}$ such that $f_{\ast} : \pi_1(Sp(\R^{2n},\Omega_0)) \rightarrow \pi_1(\con{S}^1)$ is an isomorphism. When we restrict to $Sp(\R^{2n},\Omega_0) \cap O(2n) = U(n)$, we can simply use the complex determinant $\text{det}_{\con{C}}$ of the matrix, so we just need to extent it in a way to the whole of $Sp(\R^{2n},\Omega_0)$ to get the desired map.

On the other hand, to each path $\gamma : [0,1] \rightarrow Sp(\R^{2n},\Omega_0)$ we can associate the path $f \circ \gamma : [0,1] \rightarrow \con{S}^1$ which, under the appropriate conditions, may be regarded as a closed path, so we get $\tilde{f} \circ \gamma : \con{S}^1 \rightarrow \con{S}^1$. Therefore, we can compute the degree of this path, which in turn will allow us to graduate the original path.

\subsection{The rotation map}

In this section we will describe the map representing the "rotation" part of the symplectic group as we hinted previously. Rather than constructing the map (which is a cumbersome process carried on in \cite{gutt2012conley}, where the uniqueness of such a map is also proved), we will present the properties that this map satisfies. Using them, we will then construct it in the particular case of $\R^2$ as an example.

\begin{theo}
There exists a continuous map $\rho : Sp(\R^{2n},\Omega_0) \rightarrow \con{S}^1$ satisfying the following conditions:
\begin{enumerate}
	\item {\bf Naturality:} If $A,T \in Sp(\R^{2n},\Omega_0)$, then
	\[\rho(TAT^{-1}) = \rho(A) .\]
	\item {\bf Product property:} If $A \in Sp(\R^{2n},\Omega_1)$ and $B \in Sp(\R^{2m},\Omega_2)$ (for some $\Omega_1, \Omega_2$ defining symplectic structures in $\R^{2n}, \R^{2m}$ respectively), then
	\[\rho\left(\begin{pmatrix}A & 0 \\ 0 & B\end{pmatrix}\right) = \rho(A) \rho(B) .\]
	\item {\bf Determinant property:} If $A \in U(n) = Sp(\R^ {2n},\Omega_0) \cap O(2n)$, then
	\[\rho(A) = \text{det}_{\con{C}}(X+iY),\]
	where $X,Y$ are the matrices such that
	\[A = \begin{pmatrix} X & -Y \\ Y & X \end{pmatrix}.\]
	In particular, this implies that $\rho$ induces an isomorphism on the first homotopy groups:
	\[\begin{array}{rccc} \rho_{\ast} : & \pi_1(Sp(\R^{2n},\Omega_0)) & \longrightarrow & \pi_1(\con{S}^1) \end{array} .\]
	\item {\bf Normalization:} If all the eigenvalues of $A$ are real, then
	\[\rho(A) = (-1)^{\frac{m_{-}}2},\]
	where $m_{-}$ denotes the sum of the multiplicity of all the negative eigenvalues\footnote{$m_{-}$ must always be even because all the elements of $Sp(\R^{2n},\Omega_0)$ have determinant 1}.
	\item {\bf Conjugation:} For all $A \in Sp(\R^{2n},\Omega_0)$, we have that
	\[\rho(A^T) = \rho(A^{-1}) = \overline{\rho(A)} .\]
\end{enumerate}

\end{theo}

We will not prove this theorem in general, but we will show the proof for the case of dimension 2. The general process, as we said earlier, can be seen at \cite{gutt2012conley}.

\

{\bf Construction of the rotation map in dimension 2:}

Consider $A \in Sp(\R^2,\Omega_0)$. By the properties of the rotation map, we see that the eigenvalues play a crucial role to understand its behaviour, and, in dimension 2, the eigenvalues of $A$ may simply be understood via the characteristic polynomial of $A$, that has the form
\[p_A(\lambda) = \lambda^2 - \text{tr}(A) \lambda + \text{det}(A) ,\]
and, as $A$ is symplectic, $\text{det}(A) = 1$. Therefore, the discriminant of $p_A(\lambda)$ is
\[\Delta = \text{tr}(A)^2 - 4 .\]
This way, we can classify the behaviour in the following cases:

\begin{enumerate}
	\item $|\text{tr}(A)| > 2$: this implies that $\Delta > 0$, so the matrix has two distinct real eigenvalues, $\alpha$ and $\alpha^{-1}$, which must have the same sign. Applying the normalization property, we deduce that
	\[\rho\left(\begin{pmatrix}\alpha & 0 \\ 0 & \alpha^{-1}\end{pmatrix}\right) = \left\{ \begin{array}{lc} 1 & \text{if } \alpha > 0 \\ -1 & \text{if } \alpha < 0 \end{array} \right. .\]
	If we also apply the naturality property of $\rho$, we deduce that
	\[\rho(A) = \left\{ \begin{array}{lc} 1 & \text{if tr}(A) > 2 \\ -1 & \text{if tr}(A) < -2 \end{array} \right. .\]
	\item $|\text{tr}(A)| < 2$: this implies that $\Delta < 0$, so the matrix has two distinct complex eigenvalues, $\alpha$ and $\overline{\alpha}$, with $\alpha\overline{\alpha} = 1$. Therefore, $\alpha = e^{\varphi i}$ for some $\varphi \in \R$. We may therefore choose coordinates such that
	\[A = \begin{pmatrix} \cos(\varphi) & -\sin(\varphi) \\ \sin(\varphi) & \cos(\varphi) \end{pmatrix} ,\]
	so
	\[\rho(A) = e^{\pm \varphi i} .\]
	To determine the sign in the above expression, one must take into account the orientation of the basis $(v,w)$ that one chooses to represent $A$ as stated earlier. The one that is consistent with the naturality condition is the choice of $\varphi$ such that $Az = e^{\varphi i} z$, where $z = v - iw$ with $\Omega_0(v,w) > 0$.
	\item $\text{tr}(A) = \pm 2$: this implies that $\Delta = 0$ and that $A$ has a double eigenvalue $\alpha = \pm 1$. In consequence, we can choose coordinates such that
	\[A = \begin{pmatrix} \pm 1 & 1 \\ 0 & \pm 1 \end{pmatrix} .\]
	By the continuity of $\rho$, $\rho(A)$ is the same as the limit of $\rho(A_t)$ for any continuous path that tends towards $A$. Therefore, we may choose the path of symplectic matrices
	\[A_t = \begin{pmatrix} \pm e^t & e^t \\ 0 & \pm e^{-t} \end{pmatrix} ,\]
	so
	\[\rho(A) = \lim_{t \rightarrow 0} \rho(A_t) = \pm 1 ,\]
	and we conclude that
	\[\rho(A) = \left\{ \begin{array}{lc} 1 & \text{if tr}(A) = 2 \\ -1 & \text{if tr}(A) = -2 \end{array} \right. .\]
\end{enumerate}

In the general case, one must use the product property and appropriate forms of $A$ to construct the rotation map for any symplectic matrix.

To end this section we provide a formula for $\rho$ that will be useful in the following results.

\begin{lema} \label{rotationformula}
Let $A \in Sp(\R^{2n},\Omega_0)$, and let $\lambda_1,...,\lambda_{2n}$ be its eigenvalues, repeated according to their multiplicity. The eigenvalues of first kind of $A$ are the union of the following subsets of $\{\lambda_1,...,\lambda_{2n}\}$:
\begin{enumerate}
	\item Eigenvalues with $|\lambda_i| < 1$.
	\item We know that the number of eigenvalues equal to $1$ is even, and so is the number of eigenvalues equal to $-1$. Thus, we take half of each set of eigenvalues as of first kind.
	\item If $\lambda_i = e^{i \varphi} \neq \pm 1$, then $\lambda_i^{-1}, \overline{\lambda_i}$ and $\overline{\lambda_i^{-1}}$ are also eigenvalues of $A$. Let $E_{\lambda}$ denote the sum of their (complex) eigenspaces, and let $Q$ be the quadratic form defined by
	\[\begin{array}{rccc} Q : & E_{\lambda} \times E_{\lambda} & \longrightarrow & \C \\ & (v,w) & \longmapsto & \text{Im}(\Omega_0(v,\overline{w})) \end{array} .\]
	The signature of $Q$ is $(2r,2s)$, and we take $r$ times the eigenvalue $\lambda_i$ as of the first kind.
\end{enumerate}

Then, the rotation map of $A$ can be computed as
\[\rho(A) = \prod_{\lambda_i \text{ of first kind}} \frac{\lambda_i}{|\lambda_i|} .\]
\end{lema}
